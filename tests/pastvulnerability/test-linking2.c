/*
 * RUN: clang %cflags -emit-llvm -S %s -o %t.ll
 * RUN: soaap -o %t.soaap.ll %t.ll > %t.out
 * RUN: FileCheck %s -input-file %t.out
 *
 * CHECK: Running Soaap Pass
 */
#include "soaap.h"

int b();

/*
 * This CVE does *not* trigger an ambient authority warning because we
 * don't know what context(s) it is called from:
 *
 * CHECK-NOT: Another vulnerability here would leak ambient authority
 */
int b() {
  __soaap_vuln_pt("CVE_1970_XXX")
  return 1;
}
