/*
 * RUN: clang %cflags -emit-llvm -S %s -o %t.ll
 * RUN: soaap -o %t.soaap.ll %t.ll > %t.out
 * RUN: FileCheck %s -input-file %t.out
 *
 * CHECK: Running Soaap Pass
 */
#include "soaap.h"

int main(int argc, char** argv) {
  int x;

  /*
   * CHECK: "main" has past-vulnerability annotations {{.*}}CVE_1970_XXX
   * CHECK: Another vulnerability here would leak ambient authority
   */
  __soaap_vuln_pt("CVE_1970_XXX")
  if (x) {
    printf("time is: %d\n", 123);
  }
}

__soaap_vuln_fn("CVE_1971_YYY")
void foo() {
}
