/*
 * RUN: clang %cflags -emit-llvm -S %s -o %t.ll
 * RUN: soaap -o %t.soaap.ll %t.ll > %t.out
 * RUN: FileCheck %s -input-file %t.out
 *
 * CHECK: Running Soaap Pass
 */
#include "soaap.h"

int a();

/*
 * CHECK: Function "a" has past-vulnerability annotations {{.*}}CVE-1970-XXX
 * CHECK-NEXT: Another vulnerability here would leak ambient authority
 */
int a() {
  __soaap_vuln_pt("CVE-1970-XXX")
  return 0;
}

int main(int argc, char** argv) {
  return a();
}
